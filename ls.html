<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enregistrement de fichiers dans le localStorage</title>
</head>
<body>

<input type="file" id="fileInput" accept=".p12, .txt, .mobileprovision">
<button onclick="saveFiles()">Enregistrer</button>

<script>
function saveFiles() {
  const fileInput = document.getElementById('fileInput');

  if (fileInput.files.length > 0) {
    const files = fileInput.files;

    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      readFileContent(file)
        .then(content => {
          saveToLocalStorage(file.name, content);
        })
        .catch(error => {
          console.error('Erreur lors de la lecture du fichier:', error);
          alert('Une erreur est survenue lors de la lecture du fichier.');
        });
    }
  } else {
    alert("Veuillez sélectionner au moins un fichier.");
  }
}

function readFileContent(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();

    reader.onload = function(event) {
      resolve(event.target.result);
    };

    reader.onerror = function(event) {
      reject(event.target.error);
    };

    reader.readAsText(file);
  });
}

function saveToLocalStorage(filename, content) {
  try {
    localStorage.setItem(filename, content);
    alert(`Le fichier ${filename} a été enregistré dans le localStorage.`);
  } catch (error) {
    console.error('Erreur lors de l\'enregistrement dans le localStorage:', error);
    alert('Une erreur est survenue lors de l\'enregistrement dans le localStorage.');
  }
}
</script>

</body>
</html>
